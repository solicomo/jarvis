CREATE TABLE IF NOT EXISTS users (
	id INTEGER PRIMARY KEY NOT NULL,
	username VARCHAR(255) UNIQUE NOT NULL,
	password VARCHAR(255) NOT NULL,
	name VARCHAR(255),
	email VARCHAR(255),
	role VARCHAR(255)
	);

CREATE TABLE IF NOT EXISTS metrics (
	id INTEGER PRIMARY KEY NOT NULL,
	name VARCHAR(255) UNIQUE NOT NULL,
	detector TEXT NOT NULL,
	params TEXT,
	md5 VARCHAR(255)
	};

CREATE TABLE IF NOT EXISTS nodes (
	id INTEGER PRIMARY KEY NOT NULL,
	name VARCHAR(255) UNIQUE NOT NULL,
	addr VARCHAR(255) UNIQUE NOT NULL,
	os  VARCHAR(255),
	cpu VARCHAR(255),
	uptime VARCHAR(255),
	ctime DATETIME,
	atime DATETIME
	);

CREATE TABLE IF NOT EXISTS metric_bindings (
	id INTEGER PRIMARY KEY NOT NULL,
	node INTEGER NOT NULL,
	metric INTEGER NOT NULL,
	interval INTEGER NOT NULL,
	UNIQUE(node, metric)
	);

CREATE TABLE IF NOT EXISTS metric_records (
	id INTEGER PRIMARY KEY NOT NULL,
	node INTEGER NOT NULL,
	metric INTEGER NOT NULL,
	value TEXT NOT NULL,
	ctime DATETIME,
	UNIQUE(node, metric)
	);

CREATE TABLE IF NOT EXISTS config (
	id INTEGER PRIMARY KEY NOT NULL,
	name VARCHAR(255) UNIQUE NOT NULL,
	value TEXT
	);
